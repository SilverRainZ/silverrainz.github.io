==================================
将域名从 GoDaddy 转移至 Cloudflare
==================================

.. post:: 2025-01-27
   :language: zh_CN
   :tags: 运维 域名
   :author: LA
   :location: 汕头

大家都知道的基础知识
====================

DNS 协议能将一个域名解析为主机的 IP 地址，从而访问对应的主机，在移动互联网时代，流量的入口是各类 APP 而非浏览器，域名的意义早已不那么重大。不过对于希望保持数据独立性的内容生产者来说，持有一个域名还是有必要的。

域名有点像手机号码，表面上用户可以在域名注册商（Domain Name Registrar）处「购买」域名，但实际上所有的域名都归非营利的 *互联网名称与数字地址分配机构（ICANN）* 所有，域名注册商只是租赁代理，用户也只是租客。因此，对于同一个域名，用户既可以在注册商 A 处购买，也可以在注册商 B 处购买，在 ICANN 的管理下，注册商能够保证租给你的域名是唯一的。

中心化的 ICANN 保证了域名可以被唯一地分配，而分布式的 DNS 协议则保证了，无论域名由哪个注册商管理，都能在全球范围内被正确地解析和访问。

此外，已租用域名的用户，也可以选择将租赁协议从一家注册商转移到另一家（类似携号转网），转移费用等同于域名一年的租金。

老用户不如狗
============

转移域名的原因常常是因为 *注册商提价*。不同注册商对统一域名的定价不同，且因为域名的转移/迁移成本较高，注册商会倾向于逐年提高域名的续费价格。但根据上面的基础知识可知，用户可以选择将域名转移到另一注册商。

2017 年我在狗爹（godaddy.com）购入了域名 ``silverrainz.me``，前几年价格大概在 100 CNY/yr 出头，也就一直续费着，23 涨到了 199，我开始考虑将域名转移到其他提供商。由于域名临近到期时不允许转出，也不想刚续费就马上转出浪费钱，就把事情推到了 24 年底，GoDaddy 又变本加厉地加价到了 219：

.. figure:: /_images/2025-01-22_154813.png
   :width: 50%

货比三家
========

在转移之前首先要确定哪里的注册商比较便宜且靠谱，`哪煮米 <https://www.nazhumi.com/domain/me/transfer/1>`_ 提供了域名比价的功能，可以看到我的 ``.me`` 域名在 90~100 CNY 的区间就能买到，GoDaddy 属实是欺负人了。前两个注册商我都不太熟，排第三的是大名鼎鼎的云厂商 Cloudflare：

.. figure:: /_images/2025-01-27_222614.png

CF 有个缺点是其托管的域名没法使用第三方的 nameserver，不过它作为（也许是全世界最好的）nameserver 服务提供商，用别的 nameserver 确实也说不过去。:ghuser:`pandada8` 也说 CF 的免费解析服务在国内的可访问性也还行，于是就决定选 Cloudflare 了。
  
.. seealso:: 「哪煮米」诙谐的网站介绍

   .. figure:: /_images/2025-01-23_230213.png
      :width: 80%

域名转移流程
============

将原有注册商称为 A，常规的转移流程是，确定需要转入的新注册商 B，在 A 处申请域名转出，获得一个 *转移密码*，在 B 处申请域名转入，填入转移密码，然后等待 A 同意转出，这个过程大概需要 5 天左右。

直观地想，当域名转出的时候，域名在 A 处的设置会全部失效，例如 nameserver 设置和 DNS 设置，而 B 处会让新的域名使用自家的 nameserver，DNS 设置则还是一片空白，网站会陷入一段时间的不可用状态。因此合理的转移方式应该是，*先在 A 处设置域名使用第三方的 nameserver，当然就是说「使用 B 的 nameserver」，再在 B 处导入该域名的所有 DNS 设置*，如此一来，可以在域名转移前就将所有的解析工作交给 B，让域名在转移前后都正常工作。

小小坑点
========

我分别查阅了 `GoDaddy 的转出指南 <https://www.godaddy.com/zh-sg/help/transfer-my-domain-away-from-godaddy-3560>`_ 和 `Cloudflare 的转入指南 <https://blog.cloudflare.com/zh-cn/a-step-by-step-guide-to-transferring-domains-to-cloudflare>`_，基本上按文档操作的来，就没啥问题了。

唯一卡住我的地方是文档说，在「域名组合」页面（点开来的标题是「域名总览」）如此操作即可转移域名：

.. figure:: /_images/2025-01-27_231235.png
   :width: 80%
   
但无论在 `Portfolio 页面中，选中域名时的弹出菜单项 <https://dcc.godaddy.com/control/portfolio>`_ 里，还是在 `转移页面 <https://dcc.godaddy.com/control/transfers>`_ 里，都不存在文档里提及的「转移至另一注册商/Transfer to Another Registrar」的选项。

.. grid::

   .. grid-item::

      .. figure:: /_images/2025-01-27_233454.png

         Portfolio 页面，选中域名时的弹出菜单项

   .. grid-item::


      .. figure:: /_images/2025-01-27_233644.png
   
         转移页面
 
但实际上文档也没写错，在 Portfolio 点击域名的超链接，进入域名详情，就有对应的转移选项了：

.. figure:: /_images/2025-01-27_233908.png

大家新年快乐，:people:`妹妹 <Swan>` 生日快乐～
